<html manifest="cache.appcache" lang="en-US" style="font-size: 12.9375px;">
<head id="ext-element-1">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>科传商场租户自助平台</title>
    <!-- The line below must be kept intact for Sencha Command to build your application -->
    <script id="microloader" data-app="ab9c1757-546c-498e-b4b8-354709fc81dd" type="text/javascript">
        /**
     * Sencha Blink
     * @author Jacky Nguyen <jacky@sencha.com>
     */
    (function (global) {
        var emptyFn = function () {
            },
            callbacks = [],
            doc = global.document,
            head = doc.head || doc.getElementsByTagName('head')[0],
            addWindowListener = global.addEventListener,
            removeWindowListener = global.removeEventListener,
            jsonParse = JSON.parse,
            a = doc.createElement('a'),
            documentLocation = doc.location,
            documentUri = documentLocation.protocol + '//' + documentLocation.hostname + documentLocation.pathname + documentLocation.search,
            manifestFile = 'app.json',
            isRefreshing = false,
            activeManifest, appCache, storage;

        try {
            storage = global.localStorage;
            appCache = global.applicationCache;
        }
        catch (e) {
        }

        function getManifestStorageKey(id) {
            return id + '-' + documentUri + manifestFile;
        }

        function Manifest(manifest) {
            var manifestContent;

            if (typeof manifest == 'string') {
                manifestContent = manifest;
                manifest = jsonParse(manifestContent);
            }
            else {
                manifestContent = JSON.stringify(manifest);
            }

            var applicationId = manifest.id,
                key = getManifestStorageKey(applicationId),
                assetMap = {};

            function processAsset(asset) {
                var uri;

                if (typeof asset == 'string') {
                    asset = {
                        path: asset
                    };
                }

                if (asset.shared) {
                    asset.version = asset.shared;
                    uri = asset.shared + asset.path;
                }
                else {
                    uri = toAbsoluteUri(asset.path);
                    asset.version = asset.hash;
                }

                asset.uri = uri;
                asset.key = applicationId + '-' + uri;
                assetMap[uri] = asset;

                return asset;
            }

            function processAssets(assets, type) {
                var ln = assets.length,
                    i, asset;

                for (i = 0; i < ln; i++) {
                    asset = assets[i];

                    assets[i] = asset = processAsset(asset);

                    asset.type = type;
                    asset.index = i;
                    asset.collection = assets;
                    asset.ready = false;
                    asset.evaluated = false;
                }

                return assets;
            }

            this.key = key;
            this.css = processAssets(manifest.css, 'css');
            this.js = processAssets(manifest.js, 'js');

            Ext.microloaded = true;

            var filterPlatform = window.Ext.filterPlatform = function (platform) {
                var profileMatch = false,
                    ua = navigator.userAgent,
                    j, jln;

                platform = [].concat(platform);

                function isPhone(ua) {
                    var isMobile = /Mobile(\/|\s)/.test(ua);

                    // Either:
                    // - iOS but not iPad
                    // - Android 2
                    // - Android with "Mobile" in the UA

                    return /(iPhone|iPod)/.test(ua) ||
                        (!/(Silk)/.test(ua) && (/(Android)/.test(ua) && (/(Android 2)/.test(ua) || isMobile))) ||
                        (/(BlackBerry|BB)/.test(ua) && isMobile) ||
                        /(Windows Phone)/.test(ua);
                }

                function isTablet(ua) {
                    return !isPhone(ua) && (/iPad/.test(ua) || /Android|Silk/.test(ua) || /(RIM Tablet OS)/.test(ua) ||
                        (/MSIE 10/.test(ua) && /; Touch/.test(ua)));
                }

                // Check if the ?platform parameter is set in the URL
                var paramsString = window.location.search.substr(1),
                    paramsArray = paramsString.split("&"),
                    params = {},
                    testPlatform, i;

                for (i = 0; i < paramsArray.length; i++) {
                    var tmpArray = paramsArray[i].split("=");
                    params[tmpArray[0]] = tmpArray[1];
                }

                testPlatform = params.platform;
                if (testPlatform) {
                    return platform.indexOf(testPlatform) != -1;
                }

                for (j = 0, jln = platform.length; j < jln; j++) {
                    switch (platform[j]) {
                        case 'phone':
                            profileMatch = isPhone(ua);
                            break;
                        case 'tablet':
                            profileMatch = isTablet(ua);
                            break;
                        case 'desktop':
                            profileMatch = !isPhone(ua) && !isTablet(ua);
                            break;
                        case 'ios':
                            profileMatch = /(iPad|iPhone|iPod)/.test(ua);
                            break;
                        case 'android':
                            profileMatch = /(Android|Silk)/.test(ua);
                            break;
                        case 'blackberry':
                            profileMatch = /(BlackBerry|BB)/.test(ua);
                            break;
                        case 'safari':
                            profileMatch = /Safari/.test(ua) && !(/(BlackBerry|BB)/.test(ua));
                            break;
                        case 'chrome':
                            profileMatch = /Chrome/.test(ua);
                            break;
                        case 'ie10':
                            profileMatch = /MSIE 10/.test(ua);
                            break;
                        case 'windows':
                            profileMatch = /MSIE 10/.test(ua) || /Trident/.test(ua);
                            break;
                        case 'tizen':
                            profileMatch = /Tizen/.test(ua);
                            break;
                        case 'firefox':
                            profileMatch = /Firefox/.test(ua);
                    }
                    if (profileMatch) {
                        return true;
                    }
                }
                return false;
            };

            this.css = this.css.filter(function (css) {
                var platform = css.platform,
                    exclude = css.exclude;

                css.type = "css";

                if (platform) {
                    if (filterPlatform(platform) && !filterPlatform(exclude)) {
                        if (!Ext.theme) {
                            Ext.theme = {};
                        }
                        if (!Ext.theme.name) {
                            Ext.theme.name = css.theme || 'Default';
                        }
                        return true;
                    }
                    css.filtered = true;
                    return false;
                }
                return true;
            });

            this.js = this.js.filter(function (js) {
                var platform = js.platform,
                    exclude = js.exclude;

                js.type = "js";

                if (platform) {
                    if (filterPlatform(platform) && !filterPlatform(exclude)) {
                        return true;
                    }
                    else {
                        js.filtered = true;
                        return false;
                    }
                }
                return true;
            });

            this.assets = this.css.concat(this.js);
            this.getAsset = function (uri) {
                return assetMap[uri];
            };
            this.store = function () {
                store(key, manifestContent);
            };
        }

        if (typeof global.Ext === 'undefined') {
            var Ext = global.Ext = {};
        }

        function toAbsoluteUri(uri) {
            a.href = uri;
            return a.href;
        }

        function addMeta(name, content) {
            var meta = document.createElement('meta');

            meta.setAttribute('name', name);
            meta.setAttribute('content', content);
            head.appendChild(meta);
        }

        function request(uri, isShared, onSuccess, onFailure) {
            (isShared ? requestIframe : requestXhr)(uri, onSuccess, onFailure);
        }

        function requestXhr(uri, onSuccess, onFailure) {
            var xhr = new XMLHttpRequest();

            onFailure = onFailure || emptyFn;

            uri = uri + ((uri.indexOf('?') == -1) ? '?' : '&') + Date.now();

            try {
                xhr.open('GET', uri, true);
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4) {
                        var status = xhr.status,
                            content = xhr.responseText;

                        if ((status >= 200 && status < 300) || status == 304 || (status == 0 && content.length > 0)) {
                            onSuccess(content);
                        }
                        else {
                            onFailure();
                        }
                    }
                };
                xhr.send(null);
            } catch (e) {
                onFailure();
            }
        }

        function requestIframe(uri, onSuccess) {
            var iframe = doc.createElement('iframe');

            callbacks.push({
                iframe: iframe,
                callback: onSuccess
            });

            iframe.src = uri + '.html';
            iframe.style.cssText = 'width:0;height:0;border:0;position:absolute;z-index:-999;visibility:hidden';
            doc.body.appendChild(iframe);
        }

        // for remote assets, inject a script element
        function addRemoteScript(uri, onSuccess, onFailure) {
            var script = document.createElement('script');
            script.src = uri;
            script.type = "text/javascript";
            script.charset = "UTF-8";

            script.onerror = onFailure;

            if ('addEventListener' in script) {
                script.onload = onSuccess;
            } else if ('readyState' in script) {
                script.onreadystatechange = function () {
                    if (this.readyState === 'loaded' ||
                        this.readyState === 'complete') {
                        onSuccess();
                    }
                };
            } else {
                script.onload = onSuccess;
            }

            head.appendChild(script);
        }

        function addRemoteLink(uri) {
            var link = document.createElement('link');
            link.rel = "stylesheet";
            link.href = uri;
            head.appendChild(link);
        }

        function requestAsset(asset, onSuccess, onFailure) {
            var isRemote = !!asset.remote,
                isShared = !!asset.shared;

            if (isRemote) {
                if (asset.type === "js") {
                    addRemoteScript(asset.uri, function () {
                        onSuccess('');
                    }, onFailure);
                } else {
                    addRemoteLink(asset.uri);
                    onSuccess('');
                }
                return;
            }

            if (!isShared && asset.version && asset.version.length) {
                var onRequestSuccess = onSuccess,
                    version = asset.version,
                    versionLn = version.length,
                    checksumFail, checksumType;

                onSuccess = function (content) {
                    checksumType = content.substring(0, 1);
                    if (checksumType == '/') {
                        if (content.substring(2, versionLn + 2) !== version) {
                            checksumFail = true;
                        }
                    }
                    else if (checksumType == 'f') {
                        if (content.substring(10, versionLn + 10) !== version) {
                            checksumFail = true;
                        }
                    }
                    else if (checksumType == '.') {
                        if (content.substring(1, versionLn + 1) !== version) {
                            checksumFail = true;
                        }
                    }
                    if (checksumFail === true) {
                        if (confirm("Requested: '" + asset.uri + " seems to have been changed. Attempt to refresh the application?")) {
                            refresh();
                        }
                        return;
                    }
                    onRequestSuccess(content);
                };
            }

            request(asset.uri, isShared, onSuccess, onFailure);
        }

        function onMessage(e) {
            var data = e.data,
                sourceWindow = e.source.window,
                i, ln, callback, iframe;

            for (i = 0, ln = callbacks.length; i < ln; i++) {
                callback = callbacks[i];
                iframe = callback.iframe;

                if (iframe.contentWindow === sourceWindow) {
                    callback.callback(data);
                    doc.body.removeChild(iframe);
                    callbacks.splice(i, 1);
                    return;
                }
            }
        }

        function patch(content, delta) {
            var output = [],
                chunk, i, ln;

            if (delta.length === 0) {
                return content;
            }

            for (i = 0, ln = delta.length; i < ln; i++) {
                chunk = delta[i];

                if (typeof chunk === 'number') {
                    output.push(content.substring(chunk, chunk + delta[++i]));
                }
                else {
                    output.push(chunk);
                }
            }

            return output.join('');
        }

        function log(message) {
            if (typeof console != 'undefined') {
                (console.error || console.log).call(console, message);
            }
        }

        function store(key, value) {
            try {
                storage.setItem(key, value);
            }
            catch (e) {
                if (storage && e.code == e.QUOTA_EXCEEDED_ERR && activeManifest) {
                    log("LocalStorage Quota exceeded, cannot store " + key + " locally");
                    // Quota exceeded, clean up unused items
//                var items = activeManifest.assets.map(function(asset) {
//                        return asset.key;
//                    }),
//                    i = 0,
//                    ln = storage.length,
//                    cleaned = false,
//                    item;
//
//                items.push(activeManifest.key);
//
//                while (i <= ln - 1) {
//                    item = storage.key(i);
//
//                    if (items.indexOf(item) == -1) {
//                        storage.removeItem(item);
//                        cleaned = true;
//                        ln--;
//                    }
//                    else {
//                        i++;
//                    }
//                }

                    // Done cleaning up, attempt to store the value again
                    // If there's still not enough space, no other choice
                    // but to skip this item from being stored
//                if (cleaned) {
//                    store(key, value);
//                }
                }
            }
        }

        function retrieve(key) {
            try {
                return storage.getItem(key);
            }
            catch (e) {
                // Private browsing mode
                return null;
            }
        }

        function retrieveAsset(asset) {
            return retrieve(asset.key);
        }

        function storeAsset(asset, content) {
            return store(asset.key, content);
        }

        function refresh() {
            if (!isRefreshing) {
                isRefreshing = true;
                requestXhr(manifestFile, function (content) {
                    new Manifest(content).store();
                    global.location.reload();
                });
            }
        }

        function blink(currentManifest) {
            var currentAssets = currentManifest.assets,
                assetsCount = currentAssets.length,
                newManifest;

            activeManifest = currentManifest;

            addWindowListener('message', onMessage, false);

            function onAssetReady(asset, content) {
                var assets = asset.collection,
                    index = asset.index,
                    ln = assets.length,
                    i;

                asset.ready = true;
                asset.content = content;

                for (i = index - 1; i >= 0; i--) {
                    asset = assets[i];
                    if (!asset.filtered && (!asset.ready || !asset.evaluated)) {
                        return;
                    }
                }

                for (i = index; i < ln; i++) {
                    asset = assets[i];
                    if (asset.ready) {
                        if (!asset.evaluated) {
                            evaluateAsset(asset);
                        }
                    }
                    else {
                        return;
                    }
                }
            }

            function evaluateAsset(asset) {
                asset.evaluated = true;

                if (asset.type == 'js') {
                    try {
                        asset.content = asset.content + "\n//# sourceURL=" + asset.uri + "\n";
                        eval.call(window, asset.content);
                    }
                    catch (e) {
                        log("Error evaluating " + asset.uri + " with message: " + e);
                    }
                }
                else {
                    var style = doc.createElement('style'),
                        base;

                    style.type = 'text/css';
                    asset.content = asset.content + "\n/*# sourceURL=" + asset.uri + " */\n";
                    style.textContent = asset.content;

                    if ('id' in asset) {
                        style.id = asset.id;
                    }

                    if ('disabled' in asset) {
                        style.disabled = asset.disabled;
                    }

                    base = document.createElement('base');
                    base.href = asset.path.replace(/\/[^\/]*$/, '/');
                    head.appendChild(base);
                    head.appendChild(style);
                    head.removeChild(base);
                }

                delete asset.content;

                if (--assetsCount == 0) {
                    onReady();
                }
            }

            function onReady() {
                var updatingAssets = [],
                    appCacheReady = false,
                    onAppCacheIdle = function () {
                    },
                    onAppCacheReady = function () {
                        appCache.swapCache();
                        appCacheReady = true;
                        onAppCacheIdle();
                    },
                    updatingCount;

                removeWindowListener('message', onMessage, false);

                if (appCache.status == appCache.UPDATEREADY) {
                    onAppCacheReady();
                }
                else if (appCache.status == appCache.CHECKING || appCache.status == appCache.DOWNLOADING) {
                    appCache.onupdateready = onAppCacheReady;
                    appCache.onnoupdate = appCache.onobsolete = function () {
                        onAppCacheIdle();
                    };
                }

                function notifyUpdateIfAppCacheReady() {
                    if (appCacheReady) {
                        notifyUpdate();
                    }
                }

                function notifyUpdate() {
                    var updatedCallback = Ext.onUpdated || emptyFn;

                    if ('onSetup' in Ext) {
                        Ext.onSetup(updatedCallback);
                    }
                    else {
                        updatedCallback();
                    }
                }

                function doUpdate() {
                    newManifest.store();

                    updatingAssets.forEach(function (asset) {
                        storeAsset(asset, asset.content);
                    });

                    notifyUpdate();
                }

                function onAssetUpdated(asset, content) {
                    asset.content = content;

                    if (--updatingCount == 0) {
                        if (appCache.status == appCache.IDLE) {
                            doUpdate();
                        }
                        else {
                            onAppCacheIdle = doUpdate;
                        }
                    }
                }

                function checkForUpdate() {
                    removeWindowListener('online', checkForUpdate, false);
                    requestXhr(manifestFile, function (manifestContent) {
                        activeManifest = newManifest = new Manifest(manifestContent);

                        var assets = newManifest.assets,
                            currentAsset;

                        assets.forEach(function (asset) {
                            currentAsset = currentManifest.getAsset(asset.uri);

                            if (!currentAsset || asset.version !== currentAsset.version) {
                                updatingAssets.push(asset);
                            }
                        });

                        updatingCount = updatingAssets.length;

                        if (updatingCount == 0) {
                            if (appCache.status == appCache.IDLE) {
                                notifyUpdateIfAppCacheReady();
                            }
                            else {
                                onAppCacheIdle = notifyUpdateIfAppCacheReady;
                            }
                            return;
                        }

                        updatingAssets.forEach(function (asset) {
                            var currentAsset = currentManifest.getAsset(asset.uri),
                                path = asset.path,
                                update = asset.update;

                            function updateFull() {
                                requestAsset(asset, function (content) {
                                    onAssetUpdated(asset, content);
                                });
                            }

                            // New asset (never used before)
                            // OR Shared from CDN
                            // OR Missing local storage
                            // OR Full update
                            if (!currentAsset || !update || retrieveAsset(asset) === null || update != 'delta') {
                                updateFull();
                            }
                            else {
                                requestXhr('deltas/' + path + '/' + currentAsset.version + '.json',
                                    function (content) {
                                        try {
                                            onAssetUpdated(asset, patch(retrieveAsset(asset), jsonParse(content)));
                                        }
                                        catch (e) {
                                            log("Malformed delta content received for " + asset.uri);
                                        }
                                    },
                                    updateFull
                                );
                            }
                        })
                    });
                }

                if (navigator.onLine !== false) {
                    checkForUpdate();
                }
                else {
                    addWindowListener('online', checkForUpdate, false);
                }
            }

            if (assetsCount == 0) {
                onReady();
                return;
            }

            currentAssets.forEach(function (asset) {
                var content = retrieveAsset(asset);

                if (content === null) {
                    requestAsset(asset, function (content) {
                        if (!asset.remote) {
                            storeAsset(asset, content);
                        }
                        onAssetReady(asset, content);
                    }, function () {
                        onAssetReady(asset, '');
                    });
                }
                else {
                    onAssetReady(asset, content);
                }
            });
        }

        function blinkOnDomReady(manifest) {
            if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
                var msViewportStyle = document.createElement("style");
                msViewportStyle.appendChild(
                    document.createTextNode(
                        "@media screen and (orientation: portrait) {" +
                        "@-ms-viewport {width: 320px !important;}" +
                        "}" +
                        "@media screen and (orientation: landscape) {" +
                        "@-ms-viewport {width: 560px !important;}" +
                        "}"
                    )
                );
                document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
            }

            var readyStateRe = (/MSIE 10/.test(navigator.userAgent)) ? /complete|loaded/ : /interactive|complete|loaded/;
            if (doc.readyState.match(readyStateRe) !== null) {
                blink(manifest);
            }
            else {
                addWindowListener('DOMContentLoaded', function () {
                    if (navigator.standalone) {
                        // When running from Home Screen, the splash screen will not disappear until all
                        // external resource requests finish.
                        // The first timeout clears the splash screen
                        // The second timeout allows inital HTML content to be displayed
                        setTimeout(function () {
                            setTimeout(function () {
                                blink(manifest);
                            }, 1);
                        }, 1);
                    }
                    else {
                        setTimeout(function () {
                            blink(manifest);
                        }, 1);
                    }
                }, false);
            }
        }

        Ext.blink = function (manifest) {
            var manifestContent = retrieve(getManifestStorageKey(manifest.id));

            addMeta('viewport', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no');
            addMeta('apple-mobile-web-app-capable', 'yes');
            addMeta('apple-touch-fullscreen', 'yes');

            if (manifestContent) {
                manifest = new Manifest(manifestContent);
                blinkOnDomReady(manifest);
            }
            else {
                requestXhr(manifestFile, function (content) {
                    manifest = new Manifest(content);
                    manifest.store();
                    blinkOnDomReady(manifest);
                });
            }
        };
    })(this);
    Ext.blink({id: 'ab9c1757-546c-498e-b4b8-354709fc81dd'});
    </script>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <script src="../JS/Jweixin-1.0.0.js"></script>
    <link rel="stylesheet" href="../CSS/base.css">
    <link id="cssStyle" rel="stylesheet" href="../CSS/default.css">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, minimum-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-startup-image" href="undefined">
</head>
<body id="ext-element-3" class="x-phone x-ios x-safari x-ios-9 x-webkit x-portrait"
      style="width: 100% !important; height: 100% !important;">

<script>
    if (window.TApi) TApi.LoadingMask.show();
</script>

<div class="x-container x-sized" id="ext-viewport"
     style="width: 100% !important; height: 100% !important; min-width: 300px !important;">
    <div id="nav-toolbar" class="nav-toolbar">
        <div id="nav-title">投诉</div>
        <div id="nav-back" style="visibility: visible;"></div>
        <div id="nav-custom" style="visibility: visible;"></div>
    </div>
    <div class="x-body" id="ext-element-4" style="height: 680px;">
        <div class="x-inner x-layout-card" id="ext-element-2">
            <div class="x-container x-paint-monitored x-layout-card-item x-sized" id="ext-xcontainer-22" style="">
                <div class="x-body x-scroll-view" id="ext-element-258">
                    <div class="x-scroll-bar-grid-wrapper" id="ext-element-257">
                        <div class="x-scroll-bar-grid">
                            <div>
                                <div></div>
                                <div>
                                    <div class="x-scroll-bar x-scroll-bar-x" id="ext-element-256">
                                        <div class="x-unsized x-scroll-indicator-dark x-scroll-indicator rounded x-scroll-indicator-x"
                                             id="ext-component-65" style="transform: translate3d(-10000px, 0px, 0px);">
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <div class="x-scroll-bar x-scroll-bar-x" id="ext-element-255">
                                        <div class="x-unsized x-scroll-indicator-dark x-scroll-indicator rounded x-scroll-indicator-x"
                                             id="ext-component-64" style="transform: translate3d(-10000px, 0px, 0px);">
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                        </div>
                                    </div>
                                </div>
                                <div></div>
                            </div>
                        </div>
                    </div>
                    <div id="ext-element-259" class="x-scroll-container x-size-monitored x-paint-monitored">
                        <div class="x-inner x-scroll-scroller-vertical x-size-monitored x-paint-monitored x-scroll-scroller"
                             id="ext-element-254" style="transform: translate3d(0px, 0px, 0px);">
                            <div class="x-size-monitors scroll">
                                <div class="expand"></div>
                                <div class="shrink"></div>
                            </div>
                            <div class="x-paint-monitor cssanimation"></div>
                            <div class="x-unsized" id="ext-component-66">
                                <div class="x-innerhtml" id="ext-element-260">
                                    <style>
                                        .feedback {
                                        padding-top: 1rem;
                                    }

                                    .feedback input, .feedback textarea {
                                        border: none;
                                        width: 100%;
                                        padding: 0;
                                        color: #888;
                                        background: none;
                                    }

                                    .feedback input:focus {
                                        box-shadow: none;
                                    }

                                    .feedback-img li {
                                        float: left;
                                        margin: .4rem .8rem;
                                        position: relative;
                                        display: table;
                                        width: 5rem;
                                        height: 5rem;;
                                        background: #ccc;
                                    }

                                    .feedback-img li:last-child {
                                        display: block;
                                        background: url(http://59.41.59.58:8231/posservice.mobiletenant/rest/image/icon/upload-img-ico.png) no-repeat center center #ccc;
                                        background-size: 2.5rem auto;
                                    }

                                    .feedback-img li a {
                                        width: 100%;
                                        height: 100%;
                                        display: table-cell;
                                        vertical-align: middle;
                                        overflow: hidden;
                                    }

                                    .feedback-img li img {
                                        max-width: 5rem;
                                        max-height: 5rem;
                                        display: block;
                                        margin: 0 auto;
                                    }

                                    .feedback-img li i {
                                        position: absolute;
                                        font-style: normal;
                                        font-family: arial;
                                        width: 1.5rem;
                                        height: 1.5rem;
                                        right: -.7rem;
                                        top: -.7rem;
                                        line-height: 1.3rem;
                                        font-size: 1.3rem;
                                        text-align: center;
                                        border-radius: 50%;
                                        color: #fff;
                                    }

                                    .feedback-img li span {
                                        display: block;
                                        width: 5rem;
                                        height: 5rem;
                                        overflow: hidden;
                                    }

                                    #file-img {
                                        border: none;
                                        font-size: 100px;
                                        opacity: 0;
                                        filter: alpha(opacity=0);
                                    }

                                    .feedback > p {
                                        width: 90%;
                                        margin: 1rem auto;
                                    }

                                    .feedback p button {
                                        width: 45%;
                                        float: left;
                                    }

                                    .feedback p .btn_del {
                                        background: #d0767a;
                                    }

                                    .feedback p button:last-child {
                                        float: right;
                                    }

                                    .dispose p {
                                        font-size: 1rem;
                                        color: #999;
                                        border-top: 1px solid #d0dbdd;
                                        padding: 1rem 0 .3rem;
                                    }

                                    .dispose p em {
                                        font-style: normal;
                                        color: #fe1406;
                                    }

                                    .dispose p span {
                                        float: right;
                                    }</style>
                                    <form class="feedback" id="form-suggest">
                                        <div class="write-bg"><textarea id="text-content" name="content"
                                                                        placeholder="请在此输入内容,最多可上传5张图片"
                                                                        rows="6"></textarea></div>
                                        <ul class="feedback-img write-bg clear" id="img_prew">
                                            <li><span><input type="file" id="file-img" name="images"
                                                             accept="image/*"></span></li>
                                        </ul>
                                        <p>
                                            <button id="btn_confirm" class="round-btn" style="width: 88%; float: none;">
                                                提交
                                            </button>
                                        </p>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="x-size-monitors scroll">
                            <div class="expand"></div>
                            <div class="shrink"></div>
                        </div>
                        <div class="x-paint-monitor cssanimation"></div>
                    </div>
                </div>
                <div class="x-paint-monitor cssanimation"></div>
                <script>
                    window.TApi.suggest = (function (_TApi) {
                    var _suggest = _TApi.suggest || {};
                    VNavigatorBar.updateTitle("投诉");
                    var _form = _TApi.$id("form-suggest"),
                        _suggestNo = _TApi.$id("text-suggestno"),
                        _content = _TApi.$id("text-content"),
                        _buttonDel = _TApi.$id("btn_del"),
                        _buttonConfirm = _TApi.$id("btn_confirm"),
                        _button = _TApi.$cls("round-btn"),
                        FileImg = _TApi.$id("file-img"),
                        ImgPrew = _TApi.$id("img_prew"),
                        _isNew = "1" == 1,
                        _fileList = [],
                        _removedList = [];
                    if (_button.length == 1) {
                        _buttonConfirm.style.width = '88%';
                        _buttonConfirm.style.float = 'none';
                    }
                    function getImgId(file) {
                        return file.name + "_" + file.size + "_" + file.lastModified;
                    }

                    function getFileObjById(imgId) {
                        var count = _fileList.length;
                        for (var index = 0; index < count; ++index) {
                            if (_fileList[index].imgId == imgId) return _fileList[index];
                        }
                        return null;
                    }

                    function updateFileList(file, binaryData) {
                        var imgId = getImgId(file),
                            fileObj = getFileObjById(imgId),
                            objectUrl = _TApi.image.createObjectUrl(file);
                        if (fileObj) {
                            fileObj.file = file;
                            if (binaryData) fileObj.binaryData = binaryData;
                            fileObj.objectUrl = objectUrl;
                        }
                        else {
                            fileObj = {
                                imgId: imgId,
                                file: file,
                                fileName: new Date().getTime() + "_" + file.size + "_" + Math.floor(Math.random() * 100000),
                                binaryData: binaryData,
                                objectUrl: objectUrl
                            };
                            _fileList.push(fileObj);
                        }
                        return fileObj;
                    }

                    function removeFileListByName(fileName) {
                        var count = _fileList.length;
                        for (var index = 0; index < count; ++index) {
                            if (_fileList[index].fileName == fileName) {
                                if (_removedList.indexOf(_fileList[index].fileName) < 0) _removedList.push(_fileList[index].fileName);
                                _fileList.splice(index, 1);
                                break;
                            }
                        }
                    }

                    function addImgPreview(fileObj) {
                        var imgPreview = document.createElement("li");
                        imgPreview.innerHTML = '<a><img src="' + fileObj.objectUrl + '"></a><i data-file="' + fileObj.fileName + '">x</i>';
                        ImgPrew.insertBefore(imgPreview, ImgPrew.lastElementChild);
                        // handle delete button
                        var imgPrewDel = imgPreview.getElementsByTagName("i")[0];
                        imgPrewDel.onclick = function (e) {
                            var imgPreview = e.target.parentNode;
                            var fileName = e.target.getAttribute("data-file");
                            removeFileListByName(fileName);
                            ImgPrew.removeChild(imgPreview);
                        };
                    }

                    function checkInput() {
                        /*if (!_suggestNo.value)
                         {
                         _TApi.Toast.show("SuggestNoInvalid");
                         return false;
                         }*/
                        if (!_content.value) {
                            _TApi.Toast.show("请输入内容");
                            return false;
                        }
                        return true;
                    }

                    function uploadImage(allSuccess) {
                        /*var data = new FormData();
                         data.append("suggestNo", "abc");
                         data.append("mallOrgId", _TApi.tenant.getMallOrgId());
                         data.append("tenantCode", _TApi.tenant.getTenantCode());
                         var count = (_fileList ? _fileList.length : 0);
                         for (var index = 0; index < count; ++index)
                         data.append("images", _fileList[index]);
                         TAjax.uploadForm("image/upload",
                         data,
                         function(resp)
                         {
                         console.log(resp);
                         },
                         function(e)
                         {
                         console.log(e);
                         });*/
                        var count = _fileList.length, successCount = 0, binaryData,
                            contentType = _TApi.image.getContentType(), requestOption;
                        if (count == 0 && allSuccess) allSuccess();		// check no image select
                        function checkAllsuccess() {
                            ++successCount;
                            if (successCount == count && allSuccess) allSuccess();
                        }

                        for (var index = 0; index < count; ++index) {
                            binaryData = _fileList[index].binaryData;
                            if (!binaryData) {
                                checkAllsuccess();
                                continue;
                            }
                            requestOption = {
                                contentType: contentType,
                                retryCallback: function () {
                                    checkAllsuccess();
                                },
                                callback: function (options, success, resp) {
                                    if (success) checkAllsuccess();
                                }
                            };
                            TAjax.uploadBinary("image/upload/suggest/" + _fileList[index].fileName, binaryData, requestOption);
                        }
                    }

                    function deleteSuggest() {
                        TAjax.request({
                            path: PosServicePath.MOBILETENANT_FN_DELSUGGEST,
                            params: {
                                suggestNo: _suggestNo.value
                            },
                            success: function (resp) {
                                var respObj = JSON.parse(resp.responseText);
                                switch (respObj.errorCode) {
                                    case 0:
                                        _TApi.Toast.show("删除成功");
                                        AppContext.goBack();
                                        break;
                                    default:
                                        _TApi.Toast.show(respObj.errorMessage);
                                }
                            }
                        });
                    }

                    function submitComplaint(success) {
                        // build image list
                        var imgList = [];
                        var count = _fileList.length;
                        for (var index = 0; index < count; ++index) {
                            imgList.push(_fileList[index].fileName);
                        }
                        // build request params
                        var requestParams = {
                            tenantCode: _TApi.tenant.getTenantCode(),
                            content: _content.value,
                            imgList: imgList
                        };
                        if (_isNew) {
                            requestParams.isNew = 1;
                            requestParams.mallOrgId = _TApi.tenant.getMallOrgId();
                        }
                        else {
                            requestParams.isNew = 0;
                            requestParams.suggestNo = _suggestNo.value;
                            requestParams.imgRemoved = _removedList;
                        }
                        // do request
                        TAjax.request({
                            path: PosServicePath.MOBILETENANT_FN_SUGGEST,
                            params: requestParams,
                            success: function (resp) {
                                var respObj = JSON.parse(resp.responseText);
                                switch (respObj.errorCode) {
                                    case 0:
                                        if (success) success();
                                        break;
                                    case -1:
                                        _TApi.Toast.show("投诉单号已存在");
                                        break;
                                    default:
                                        _TApi.Toast.show(respObj.errorMessage);
                                }
                            }
                        });
                    }

                    _form.onsubmit = function (e) {
                        e.preventDefault();
                        return false;
                    };
                    if (_buttonDel) {
                        _buttonDel.onclick = function () {
                            deleteSuggest();
                        };
                    }
                    _buttonConfirm.onclick = function () {
                        if (!checkInput()) return;
                        uploadImage(function () {
                            submitComplaint(function () {
                                _TApi.Toast.show("更新成功");
                                AppContext.goBack();
                            });
                        });
                    };
                    FileImg.onchange = function () {
                        var count = FileImg.files.length;
                        if (count > -1) {
                            var imgId, file, fileObj;
                            for (var index = 0; index < count; ++index) {
                                file = FileImg.files[index];
                                imgId = getImgId(file);
                                // check exist
                                if (getFileObjById(imgId)) continue;
                                // check max
                                if (_fileList.length >= 5) {
                                    _TApi.Toast.show("最多上传5张图片");
                                    break;
                                }
                                // compress image
                                _TApi.image.compressFile(file, function (base64, file) {
                                    var binaryData = _TApi.image.base64ToBinary(base64);
                                    updateFileList(file, binaryData);
                                });
                                // add to file list
                                fileObj = updateFileList(file);
                                // add preview
                                addImgPreview(fileObj);
                            }
                        }
                        return true;
                    };
                    // export function
                    _suggest.updateFileListFromServer = function (fileList) {
                        var count = fileList.length, fileObj;
                        for (var index = 0; index < count; ++index) {
                            fileObj = {
                                fileName: fileList[index].imgName,
                                objectUrl: fileList[index].imgUrl
                            };
                            _fileList.push(fileObj);
                            addImgPreview(fileObj);
                        }
                    };
                    return _suggest;
                })(window.TApi);</script>
            </div>
        </div>
    </div>
</div>
<iframe style="visibility: hidden !important; width: 0px !important; height: 0px !important; position: absolute !important; border: 0px !important;">

</iframe>
</body>
</html>